(function(){"use strict";var e={2338:function(e,t,n){var o=n(9242),a=n(3396);function r(e,t,n,o,r,l){const s=(0,a.up)("router-view"),u=(0,a.up)("AppLayout");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s)])),_:1})}function l(e,t,n,o,r,l){const s=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("nav",null,[(0,a._)("ul",null,[(0,a._)("li",null,[(0,a._)("strong",null,[(0,a.Wm)(s,{to:"/"},{default:(0,a.w5)((()=>[(0,a.Uk)("leakless")])),_:1})])]),(0,a._)("li",null,[(0,a._)("strong",null,[(0,a.Wm)(s,{to:"/companies"},{default:(0,a.w5)((()=>[(0,a.Uk)("companies")])),_:1})])])]),(0,a._)("ul",null,[(0,a._)("li",null,[l.loggedIn?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(s,{key:0,to:"/register"},{default:(0,a.w5)((()=>[(0,a.Uk)("register")])),_:1}))]),(0,a._)("li",null,[l.loggedIn?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(s,{key:0,to:"/login"},{default:(0,a.w5)((()=>[(0,a.Uk)("login")])),_:1}))]),(0,a._)("li",null,[l.loggedIn?((0,a.wg)(),(0,a.j4)(s,{key:0,to:"/me"},{default:(0,a.w5)((()=>[(0,a.Uk)("my company")])),_:1})):(0,a.kq)("",!0)]),(0,a._)("li",null,[l.loggedIn?((0,a.wg)(),(0,a.j4)(s,{key:0,to:"/",onClick:l.logout,role:"button"},{default:(0,a.w5)((()=>[(0,a.Uk)("logout")])),_:1},8,["onClick"])):(0,a.kq)("",!0)])])]),(0,a.WI)(e.$slots,"default")],64)}var s={computed:{loggedIn(){return null!=localStorage.token},token(){return localStorage.token}},methods:{logout(){localStorage.removeItem("token")}}},u=n(89);const i=(0,u.Z)(s,[["render",l]]);var c=i,d={components:{AppLayout:c}};const m=(0,u.Z)(d,[["render",r]]);var p=m,h=n(2483);function g(e,t,n,o,a,r){return" aaaaaaaaaa "}var y={};const w=(0,u.Z)(y,[["render",g]]);var _=w;const f={class:"container"},v={class:"grid"},k=(0,a._)("hgroup",null,[(0,a._)("h1",null,"login"),(0,a._)("h2",null,"login with your company")],-1),b=(0,a._)("button",{type:"submit",class:"contrast"},"Login",-1),I=(0,a._)("div",null,null,-1);function D(e,t,n,r,l,s){return(0,a.wg)(),(0,a.iD)("main",f,[(0,a._)("article",v,[(0,a._)("div",null,[k,(0,a._)("form",{onSubmit:t[3]||(t[3]=(...e)=>s.register&&s.register(...e))},[(0,a.wy)((0,a._)("input",{type:"text",name:"login","onUpdate:modelValue":t[0]||(t[0]=t=>e.login=t),placeholder:"login","aria-label":"login",autocomplete:"nickname",required:""},null,512),[[o.nr,e.login]]),(0,a.wy)((0,a._)("input",{type:"text",name:"companyName","onUpdate:modelValue":t[1]||(t[1]=t=>e.companyName=t),placeholder:"company name","aria-label":"company name",autocomplete:"nickname",required:""},null,512),[[o.nr,e.companyName]]),(0,a.wy)((0,a._)("input",{type:"password",name:"password","onUpdate:modelValue":t[2]||(t[2]=t=>e.password=t),placeholder:"password","aria-label":"password",autocomplete:"current-password",required:""},null,512),[[o.nr,e.password]]),b],32)]),I])])}n(560);var S=n(4161),z={methods:{async register(e){e.preventDefault();try{let e=await S.Z.post("register",{login:this.login,name:this.companyName,password:this.password});localStorage.token=e.data.message.jwt,this.$router.push({name:"index"})}catch(t){console.log(t),this.$router.push({name:"error",query:{error:JSON.stringify(t.response.data.message)}})}}},data:function(){return{login:null,companyName:null,password:null}}};const $=(0,u.Z)(z,[["render",D]]);var q=$;const Z={class:"container"},U={class:"grid"},x=(0,a._)("hgroup",null,[(0,a._)("h1",null,"login"),(0,a._)("h2",null,"login with your company")],-1),O=(0,a._)("button",{type:"submit",class:"contrast"},"Login",-1),N=(0,a._)("div",null,null,-1);function C(e,t,n,r,l,s){return(0,a.wg)(),(0,a.iD)("main",Z,[(0,a._)("article",U,[(0,a._)("div",null,[x,(0,a._)("form",{onSubmit:t[2]||(t[2]=(...e)=>s.doLogin&&s.doLogin(...e))},[(0,a.wy)((0,a._)("input",{type:"text",name:"login","onUpdate:modelValue":t[0]||(t[0]=t=>e.login=t),placeholder:"login","aria-label":"login",autocomplete:"nickname",required:""},null,512),[[o.nr,e.login]]),(0,a.wy)((0,a._)("input",{type:"password",name:"password","onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),placeholder:"password","aria-label":"password",autocomplete:"current-password",required:""},null,512),[[o.nr,e.password]]),O],32)]),N])])}var j={methods:{async doLogin(e){e.preventDefault();try{let e=await S.Z.post("login",{login:this.login,name:this.name,password:this.password});localStorage.token=e.data.message.jwt,this.$router.push({name:"index"})}catch(t){console.log(t),this.$router.push({name:"error",query:{error:JSON.stringify(t.response.data.message)}})}}},data:function(){return{login:null,password:null}}};const H=(0,u.Z)(j,[["render",C]]);var J=H,W=n(7139);const B={class:"container"},L={class:"grid"},Y=(0,a._)("h1",null,"error",-1);function V(e,t,n,o,r,l){return(0,a.wg)(),(0,a.iD)("main",B,[(0,a._)("article",L,[(0,a._)("div",null,[Y,(0,a._)("mark",null,(0,W.zw)(this.$route.query["error"]),1)])])])}var A={};const T=(0,u.Z)(A,[["render",V]]);var K=T;const E={role:"grid"},M=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"id"),(0,a._)("th",{scope:"col"},"name"),(0,a._)("th",{scope:"col"},"login"),(0,a._)("th",{scope:"col"},"view company"),(0,a._)("th",{scope:"col"},"publish document")])],-1),P={scope:"row"};function F(e,t,n,o,r,l){const s=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("table",E,[M,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.companies,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("th",P,(0,W.zw)(t.id),1),(0,a._)("td",null,(0,W.zw)(t.name),1),(0,a._)("td",null,(0,W.zw)(t.login),1),(0,a._)("td",null,[e.loggedIn?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(s,{key:0,to:{name:"company",params:{companyId:t.id}}},{default:(0,a.w5)((()=>[(0,a.Uk)("view")])),_:2},1032,["to"]))]),(0,a._)("td",null,[e.loggedIn?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(s,{key:0,to:{name:"putDocument",params:{companyId:t.id}}},{default:(0,a.w5)((()=>[(0,a.Uk)("publish")])),_:2},1032,["to"]))])])))),128))])])}var R={async mounted(){await this.getCompanies()},methods:{async getCompanies(){try{let e=await S.Z.get("companies?offset=0&limit=100");this.companies=e.data.message.companies}catch(e){console.log(e),this.$router.push({name:"error",query:{error:JSON.stringify(e.response.data.message)}})}}},data:function(){return{companies:[]}}};const G=(0,u.Z)(R,[["render",F]]);var Q=G;const X=(0,a._)("h2",null," documents: ",-1),ee={role:"grid"},te=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"id"),(0,a._)("th",null,"sanitized")])],-1),ne={scope:"row"};function oe(e,t,n,o,r,l){const s=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("h1",null,(0,W.zw)(e.company.name),1),(0,a._)("h2",null,(0,W.zw)(e.company.login),1),X,(0,a._)("table",ee,[te,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.company.documents,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.toString()},[(0,a._)("th",ne,(0,W.zw)(e),1),(0,a._)("td",null,[(0,a.Wm)(s,{to:{name:"sanitized",params:{documentId:e}}},{default:(0,a.w5)((()=>[(0,a.Uk)("view")])),_:2},1032,["to"])])])))),128))])]),(0,a.Wm)(s,{to:{name:"putDocument",params:{companyId:e.company.id+1-1}},role:"button"},{default:(0,a.w5)((()=>[(0,a.Uk)("+")])),_:1},8,["to"])],64)}var ae={async mounted(){await this.getCompany()},methods:{async getCompany(){try{let e=await S.Z.get("company/"+this.companyId);this.company=e.data.message}catch(e){console.log(e),this.$router.push({name:"error",query:{error:JSON.stringify(e.response.data.message)}})}}},data:function(){return{company:[],companyId:this.$route.params["companyId"]}}};const re=(0,u.Z)(ae,[["render",oe]]);var le=re;const se={class:"container"},ue={class:"grid"};function ie(e,t,n,o,r,l){return(0,a.wg)(),(0,a.iD)("main",se,[(0,a._)("article",ue,[(0,a._)("div",null,[(0,a._)("h1",null,(0,W.zw)(e.document.id),1),(0,a._)("p",null,(0,W.zw)(e.document.text),1)])])])}var ce={async mounted(){await this.getDocument()},methods:{async getDocument(){try{let e=await S.Z.get("doc/"+this.documentId+"/sanitized");this.document=e.data.message}catch(e){console.log(e),this.$router.push({name:"error",query:{error:JSON.stringify(e.response.data.message)}})}}},data:function(){return{document:[],documentId:this.$route.params["documentId"]}}};const de=(0,u.Z)(ce,[["render",ie]]);var me=de;const pe={class:"container"},he={class:"grid"};function ge(e,t,n,o,r,l){return(0,a.wg)(),(0,a.iD)("main",pe,[(0,a._)("article",he,[(0,a._)("div",null,[(0,a._)("h1",null,(0,W.zw)(e.document.id),1),(0,a._)("p",null,(0,W.zw)(e.document.text),1)])])])}var ye={async mounted(){await this.getCompany()},methods:{async getDocument(){try{let e=await S.Z.get(`doc/${this.documentId}`,{headers:{Authorization:`Bearer ${localStorage.token}`}});this.document=e.data.message}catch(e){console.log(e),this.$router.push({name:"error",query:{error:JSON.stringify(e.response.data.message)}})}}},data:function(){return{document:[],documentId:this.$route.params["documentId"]}}};const we=(0,u.Z)(ye,[["render",ge]]);var _e=we;const fe={class:"container"},ve={class:"grid"},ke=(0,a._)("hgroup",null,[(0,a._)("h1",null,"add a secret")],-1),be=(0,a._)("button",{type:"submit",class:"contrast"},"add",-1),Ie=(0,a._)("div",null,null,-1);function De(e,t,n,r,l,s){return(0,a.wg)(),(0,a.iD)("main",fe,[(0,a._)("article",ve,[(0,a._)("div",null,[ke,(0,a._)("form",{onSubmit:t[1]||(t[1]=(...e)=>s.addSecret&&s.addSecret(...e))},[(0,a.wy)((0,a._)("input",{type:"text",name:"secret","onUpdate:modelValue":t[0]||(t[0]=t=>e.secret=t),placeholder:"secret","aria-label":"secret",required:""},null,512),[[o.nr,e.secret]]),be],32)]),Ie])])}var Se={methods:{async addSecret(e){e.preventDefault();try{await S.Z.put("/me/secret",{secret:this.secret},{headers:{Authorization:`Bearer ${localStorage.token}`}}),this.$router.push({name:"me"})}catch(t){console.log(t),this.$router.push({name:"error",query:{error:JSON.stringify(t.response.data.message)}})}}},data:function(){return{secret:null}}};const ze=(0,u.Z)(Se,[["render",De]]);var $e=ze;const qe={class:"container"},Ze={class:"grid"},Ue=(0,a._)("hgroup",null,[(0,a._)("h1",null,"add a document")],-1),xe=(0,a._)("button",{type:"submit",class:"contrast"},"add",-1),Oe=(0,a._)("div",null,null,-1),Ne=(0,a._)("h2",null,"potential secrets so far:",-1),Ce={role:"grid"};function je(e,t,n,r,l,s){return(0,a.wg)(),(0,a.iD)("main",qe,[(0,a._)("article",Ze,[(0,a._)("div",null,[Ue,(0,a._)("form",{onSubmit:t[2]||(t[2]=(...e)=>s.addDocument&&s.addDocument(...e))},[(0,a.wy)((0,a._)("textarea",{type:"textarea",name:"document","onUpdate:modelValue":t[0]||(t[0]=t=>e.document=t),rows:"15",cols:"50",placeholder:"document","aria-label":"document",onChange:t[1]||(t[1]=(...e)=>s.handleTextChange&&s.handleTextChange(...e)),required:""},null,544),[[o.nr,e.document]]),xe],32)]),Oe,Ne,(0,a._)("table",Ce,[(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.secrets,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.toString()},[(0,a._)("td",null,(0,W.zw)(e),1)])))),128))])])])])}var He={async mounted(){await this.getHashes()},methods:{async getHashes(){try{let e=await S.Z.get(`company/${this.companyId}/hashes`,{headers:{Authorization:`Bearer ${localStorage.token}`}});this.hashes=e.data.message,this.hashes.p=BigInt(this.hashes.p),this.hashes.q=BigInt(this.hashes.q)}catch(e){console.log(e),this.$router.push({name:"error",query:{error:JSON.stringify(e.response.data.message)}})}},async addDocument(e){e.preventDefault();let t=this.$route.params["companyId"];try{await S.Z.put(`/company/${this.companyId}/doc`,{text:this.document}),this.$router.push({name:"company",params:{companyId:t}})}catch(n){console.log(n),this.$router.push({name:"error",query:{error:JSON.stringify(n.response.data.message)}})}},async handleTextChange(){function e(e,t,n){let o=1n;while(0n!=t)t%2n==1n&&(o=o*e%n),e=e*e%n,t/=2n;return o}const t=new TextEncoder;let n=t.encode(event.target.value),o=this.hashes,a=new Map,r=[],l=0n;r.push(l);for(let s=0n;s<n.length;s++)l*=o.q,l=(l+BigInt(n[s]))%o.p,r.push(l);for(let s=0n;s<o.hashes.length;s++){let e=BigInt(o.hashes[s].len);null==a.get(e)&&a.set(e,[]),a.get(e).push(o.hashes[s].hash)}this.secrets=[];for(const[s,u]of a)for(let t=0n;t<BigInt(n.length)-s+1n;t++){let n=(o.p+r[t+s]-r[t]*e(o.q,s,o.p)%o.p)%o.p;for(const e of u)e==n&&this.secrets.push(event.target.value.slice(Number(t),Number(t+s)))}}},data:function(){return{secrets:[],secretHashes:[],document:null,companyId:this.$route.params["companyId"]}}};const Je=(0,u.Z)(He,[["render",je]]);var We=Je;const Be=(0,a._)("h2",null," documents: ",-1),Le={role:"grid"},Ye=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"id"),(0,a._)("th",null,"sanitized"),(0,a._)("th",null,"raw")])],-1),Ve={scope:"row"},Ae=(0,a._)("h2",null,"secrets:",-1),Te={role:"grid"},Ke=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{scope:"col"},"id"),(0,a._)("th",null,"secret")])],-1),Ee={scope:"row"};function Me(e,t,n,o,r,l){const s=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Uk)((0,W.zw)(e.company.id)+" ",1),(0,a._)("h1",null,(0,W.zw)(e.company.name),1),(0,a._)("h2",null,(0,W.zw)(e.company.login),1),Be,(0,a._)("table",Le,[Ye,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.company.documents,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.toString()},[(0,a._)("th",Ve,(0,W.zw)(e),1),(0,a._)("td",null,[(0,a.Wm)(s,{to:{name:"sanitized",params:{documentId:e}}},{default:(0,a.w5)((()=>[(0,a.Uk)("view")])),_:2},1032,["to"])]),(0,a._)("td",null,[(0,a.Wm)(s,{to:{name:"document",params:{documentId:e}}},{default:(0,a.w5)((()=>[(0,a.Uk)("view")])),_:2},1032,["to"])])])))),128))])]),(0,a.Wm)(s,{to:{name:"putDocument",params:{companyId:e.company.id+1-1}},role:"button"},{default:(0,a.w5)((()=>[(0,a.Uk)("+")])),_:1},8,["to"]),Ae,(0,a._)("table",Te,[Ke,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.company.secrets,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("th",Ee,(0,W.zw)(e.id),1),(0,a._)("td",null,(0,W.zw)(e.secret),1)])))),128))])]),(0,a._)("li",null,[(0,a.Wm)(s,{to:"/me/secret",role:"button"},{default:(0,a.w5)((()=>[(0,a.Uk)("+")])),_:1})])],64)}var Pe={async mounted(){await this.getCompany()},methods:{async getCompany(){try{let e=await S.Z.get("/me",{headers:{Authorization:`Bearer ${localStorage.token}`}});this.company=e.data.message}catch(e){console.log(e),this.$router.push({name:"error",query:{error:JSON.stringify(e.response.data.message)}})}}},data:function(){return{company:{}}}};const Fe=(0,u.Z)(Pe,[["render",Me]]);var Re=Fe;const Ge=[{path:"/",name:"index",component:_},{path:"/register",name:"register",component:q},{path:"/login",name:"login",component:J},{path:"/error",name:"error",component:K},{path:"/companies",name:"companies",component:Q},{path:"/company/:companyId",name:"company",component:le},{path:"/doc/:documentId/sanitized",name:"sanitized",component:me},{path:"/doc/:documentId",name:"document",component:_e},{path:"/me",name:"me",component:Re},{path:"/me/secret",name:"putSecret",component:$e},{path:"/company/:companyId/doc",name:"putDocument",component:We}],Qe=(0,h.p7)({history:(0,h.r5)(),routes:Ge});var Xe=Qe;let et="";et=window.location.origin;const tt=et,nt=`${tt}/api`;S.Z.defaults.baseURL=nt,S.Z.defaults.withCredentials=!0,(0,o.ri)(p).use(Xe).mount("#app")}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],r=e[c][2];for(var s=!0,u=0;u<o.length;u++)(!1&r||l>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[u])}))?o.splice(u--,1):(s=!1,r<l&&(l=r));if(s){e.splice(c--,1);var i=a();void 0!==i&&(t=i)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,l=o[0],s=o[1],u=o[2],i=0;if(l.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(u)var c=u(n)}for(t&&t(o);i<l.length;i++)r=l[i],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},o=self["webpackChunkleakless"]=self["webpackChunkleakless"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2338)}));o=n.O(o)})();
//# sourceMappingURL=app.c2d1323a.js.map